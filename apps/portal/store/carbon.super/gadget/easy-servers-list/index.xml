<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs title="Servers" description="Select Servers">
        <Require feature="pubsub-2"/>
        <Require feature="dynamic-height"/>
    </ModulePrefs>
    <Content type="html">
        <![CDATA[
        <head>
            <meta charset="utf-8">
            <title>Select Servers</title>
            <link rel="stylesheet" href="/portal/css/bootstrap.min.css" type="text/css"/>
            <link rel="stylesheet" href="css/image-picker.css" type="text/css"/>
            <style>
                .thumbnail {
                    text-align: center;
                    cursor: pointer;
                }
                .thumbnail p {
                    margin-bottom: 0;
                }
            </style>
            <script src="/portal/js/jquery-1.10.2.js"></script>
            <script src="/portal/js/bootstrap.min.js"></script>
            <script src="js/image-picker.min.js"></script>
            <script>
                $(function() {
                    var servers = $('#servers-list');
                    var url = '/portal/store/carbon.super/gadget/servers-list/api/as-data.jag';
                    var data = { action: 'node-list' };
                    var success = function(data) {
                        var html = '<option value="" data-img-src="/portal/store/carbon.super/gadget/easy-servers-list/img/network.png">All</option>';
                        data.forEach(function(server) {
                            html += '<option data-img-src="/portal/store/carbon.super/gadget/easy-servers-list/img/server.png">' + server + '</option>';
                        });
                        servers.html(html);
                        servers.imagepicker({
                            show_label: true
                        });
                        servers.on('change', function() {
                            var server = servers.val();
                            gadgets.Hub.publish('select', server);
                        });
                    };
                    $.ajax({
                        url: url,
                        type: "GET",
                        dataType: "json",
                        data: data,
                        success: success
                    });
                });
            </script>
        </head>
        <body>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <form role="form">
                            <h3>Servers</h3>
                            <select id="servers-list" class="form-control"></select>
                        </form>
                    </div>
                </div>
            </div>
        </body>
        ]]>
    </Content>
</Module>